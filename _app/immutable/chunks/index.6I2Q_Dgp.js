import{n as f,w as a,x as p}from"./utils.BR-QKrHv.js";const r=[];function _(s,i=f){let e=null;const o=new Set;function u(n){if(p(s,n)&&(s=n,e)){const c=!r.length;for(const t of o)t[1](),r.push(t,s);if(c){for(let t=0;t<r.length;t+=2)r[t][0](r[t+1]);r.length=0}}}function b(n){u(n(s))}function l(n,c=f){const t=[n,c];return o.add(t),o.size===1&&(e=i(u,b)||f),n(s),()=>{o.delete(t),o.size===0&&e&&(e(),e=null)}}return{set:u,update:b,subscribe:l}}function d(s){let i;return a(s,e=>i=e)(),i}export{d as g,_ as w};
